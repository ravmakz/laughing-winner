<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Index of Association — ia • poppr</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">poppr</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="http://github.com/grunwaldlab/poppr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Index of Association</h1>
    </div>

    
    <p>Calculate the Index of Association and Standardized Index of Association. 
Obtain p-values from one-sided permutation tests.</p>
    

    <pre class="usage"><span class='fu'>ia</span>(<span class='no'>gid</span>, <span class='kw'>sample</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>quiet</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>missing</span> <span class='kw'>=</span> <span class='st'>"ignore"</span>,
  <span class='kw'>plot</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>hist</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>index</span> <span class='kw'>=</span> <span class='st'>"rbarD"</span>, <span class='kw'>valuereturn</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)

<span class='fu'>pair.ia</span>(<span class='no'>gid</span>, <span class='kw'>quiet</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>plot</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>low</span> <span class='kw'>=</span> <span class='st'>"blue"</span>, <span class='kw'>high</span> <span class='kw'>=</span> <span class='st'>"red"</span>,
  <span class='kw'>limits</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>index</span> <span class='kw'>=</span> <span class='st'>"rbarD"</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>gid</th>
      <td><p>a <code>genind</code> or <code><a href='genclone-class.html'>genclone</a></code> object.</p></td>
    </tr>
    <tr>
      <th>sample</th>
      <td><p>an integer indicating the number of permutations desired (eg 
999).</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>an integer from 1 to 4 indicating the sampling method desired. 
see <code><a href='shufflepop.html'>shufflepop</a></code> for details.</p></td>
    </tr>
    <tr>
      <th>quiet</th>
      <td><p>Should the function print anything to the screen while it is 
performing calculations?

<code>TRUE</code> prints nothing.

<code>FALSE</code> (default) will print the population name and progress bar.</p></td>
    </tr>
    <tr>
      <th>missing</th>
      <td><p>a character string. see <code><a href='missingno.html'>missingno</a></code> for details.</p></td>
    </tr>
    <tr>
      <th>plot</th>
      <td><p>When <code>TRUE</code> (default), a heatmap of the values per locus
pair will be plotted (for pair.ia). For `ia()`, if <code>sampling &gt; 0</code>, a
histogram will be produced for each population.</p></td>
    </tr>
    <tr>
      <th>hist</th>
      <td><p><code>logical</code> Deprecated. Use plot.</p></td>
    </tr>
    <tr>
      <th>index</th>
      <td><p><code>character</code> either "Ia" or "rbarD". If <code>hist = TRUE</code>, 
this indicates which index you want represented in the plot (default:
"rbarD").</p></td>
    </tr>
    <tr>
      <th>valuereturn</th>
      <td><p><code>logical</code> if <code>TRUE</code>, the index values from the 
reshuffled data is returned. If <code>FALSE</code> (default), the index is 
returned with associated p-values in a 4 element numeric vector.</p></td>
    </tr>
    <tr>
      <th>low</th>
      <td><p>(for pair.ia) a color to use for low values when <code>plot =
TRUE</code></p></td>
    </tr>
    <tr>
      <th>high</th>
      <td><p>(for pair.ia) a color to use for low values when <code>plot =
TRUE</code></p></td>
    </tr>
    <tr>
      <th>limits</th>
      <td><p>(for pair.ia) the limits to be used for the color scale. 
Defaults to <code>NULL</code>. If you want to use a custom range, supply two
numbers between -1 and 1, (e.g. <code>limits = c(-0.15, 1)</code>)</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    
<h3>for <code>pair.ia</code></h3>

  A matrix with two columns and choose(nLoc(gid), 2) rows representing the
  values for Ia and rbarD per locus pair.
  <p></p><h3>If no sampling has occurred:</h3>
 
  A named number vector of length 2 giving the Index of Association, "Ia";
  and the Standardized Index of Association, "rbarD" 
  <p></p><h3>If there is sampling:</h3>
 A a named number vector of length 4
  with the following values:
  <ul>
<li><p>Ia - numeric. The index of association.</p></li>
<li><p>p.Ia - A number indicating the p-value resulting from a
    one-sided permutation test based on the number of samples indicated in
    the original call.</p></li>
<li><p>rbarD - numeric. The standardized index of association.</p></li>
<li><p>p.rD - A factor indicating the p-value resulting from a
    one-sided permutation test based on the number of samples indicated in
    the original call.</p></li>
</ul>
  <p></p><h3>If there is sampling and valureturn = TRUE</h3>
 
  A list with the following elements:
  <ul>
<li><p>index The above vector</p></li>
<li><p>samples A data frame with s by 2 column data frame where s is the
    number of samples defined. The columns are for the values of Ia and
    rbarD, respectively.</p></li>
</ul>
  

    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The function <code>ia</code> will calculate the index of association over all loci in the data set while
<code>pair.ia</code> will calculate the index in a pairwise manner among all loci.</p>
<p>The index of association was originally developed by A.H.D. Brown 
  analyzing population structure of wild barley (Brown, 1980). It has been widely 
  used as a tool to detect clonal reproduction within populations . 
  Populations whose members are undergoing sexual reproduction, whether it be
  selfing or out-crossing, will produce gametes via meiosis, and thus have a 
  chance to shuffle alleles in the next generation. Populations whose members
  are undergoing clonal reproduction, however, generally do so via mitosis. 
  This means that the most likely mechanism for a change in genotype is via 
  mutation. The rate of mutation varies from species to species, but it is 
  rarely sufficiently high to approximate a random shuffling of alleles. The 
  index of association is a calculation based on the ratio of the variance of
  the raw number of differences between individuals and the sum of those 
  variances over each locus . You can also think of it as the observed 
  variance over the expected variance. If they  are the same, then the index 
  is zero after subtracting one (from Maynard-Smith, 1993): $$I_A = 
  \frac{V_O}{V_E}-1$$ Since the distance is more or less a binary 
  distance, any sort of marker can be used for this analysis. In the 
  calculation, phase is not considered, and any difference increases the 
  distance between two individuals. Remember that each column represents a 
  different allele and that each entry in the table represents the fraction 
  of the genotype made up by that allele at that locus. Notice also that the 
  sum of the rows all equal one. Poppr uses this to calculate distances by 
  simply taking the sum of the absolute values of the differences between 
  rows.
    The calculation for the distance between two individuals at a single locus 
  with <em>a</em> allelic states and a ploidy of <em>k</em> is as follows (except
  for Presence/Absence data): $$ d = \displaystyle 
  \frac{k}{2}\sum_{i=1}^{a} \mid A_{i} - B_{i}\mid $$ 
  To find the total number of differences 
  between two individuals over all loci, you just take <em>d</em> over <em>m</em>
  loci, a value we'll call <em>D</em>:
    $$D = \displaystyle \sum_{i=1}^{m} d_i $$
    These values are calculated over all possible combinations of individuals 
  in the data set, \({n \choose 2}\) after which you end up 
  with \({n \choose 2}\cdot{}m\) values of <em>d</em> and 
  \({n \choose 2}\) values of <em>D</em>. Calculating the 
  observed variances is fairly straightforward (modified from Agapow and 
  Burt, 2001):
    $$ V_O = \frac{\displaystyle \sum_{i=1}^{n \choose 2} D_{i}^2 - 
  \frac{(\displaystyle\sum_{i=1}^{n \choose 2} D_{i})^2}{{n \choose 2}}}{{n 
  \choose 2}}$$
    Calculating the expected variance is the sum of each of the variances of 
  the individual loci. The calculation at a single locus, <em>j</em> is the 
  same as the previous equation, substituting values of <em>D</em> for 
  <em>d</em>:
    $$ var_j = \frac{\displaystyle \sum_{i=1}^{n \choose 2} d_{i}^2 - 
  \frac{(\displaystyle\sum_{i=1}^{n \choose 2} d_i)^2}{{n \choose 2}}}{{n 
  \choose 2}} $$
    The expected variance is then the sum of all the variances over all 
  <em>m</em> loci:
    $$ V_E = \displaystyle \sum_{j=1}^{m} var_j $$
    Agapow and Burt showed that \(I_A\) increases steadily with the
  number of loci, so they came up with an approximation that is widely used,
  \(\bar r_d\). For the derivation, see the manual for
  <em>multilocus</em>.
    $$ \bar r_d = \frac{V_O - V_E} {2\displaystyle 
  \sum_{j=1}^{m}\displaystyle \sum_{k \neq j}^{m}\sqrt{var_j\cdot{}var_k}} 
  $$</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Paul-Michael Agapow and Austin Burt. Indices of multilocus 
  linkage disequilibrium. <em>Molecular Ecology Notes</em>, 1(1-2):101-102, 
  2001
    A.H.D. Brown, M.W. Feldman, and E. Nevo. Multilocus structure of natural 
  populations of <em>Hordeum spontaneum</em>. <em>Genetics</em>, 96(2):523-536, 1980.
    J M Smith, N H Smith, M O'Rourke, and B G Spratt. How clonal are bacteria? 
  Proceedings of the National Academy of Sciences, 90(10):4384-4388, 1993.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code><a href='poppr.html'>poppr</a></code>, <code><a href='missingno.html'>missingno</a></code>, 
  <code>import2genind</code>, <code><a href='read.genalex.html'>read.genalex</a></code>, 
  <code><a href='clonecorrect.html'>clonecorrect</a></code>, <code><a href='win.ia.html'>win.ia</a></code>, <code><a href='samp.ia.html'>samp.ia</a></code></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>data</span>(<span class='no'>nancycats</span>)
<span class='fu'>ia</span>(<span class='no'>nancycats</span>)</div><div class='output co'>#&gt;         Ia      rbarD 
#&gt; 0.17207262 0.02178965 </div><div class='input'>
<span class='co'># Pairwise over all loci:</span>
<span class='fu'>data</span>(<span class='no'>partial_clone</span>)
<span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='fu'>pair.ia</span>(<span class='no'>partial_clone</span>)</div><div class='output co'>#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |==                                                                    |   2%  |                                                                              |===                                                                   |   4%  |                                                                              |=====                                                                 |   7%  |                                                                              |======                                                                |   9%  |                                                                              |========                                                              |  11%  |                                                                              |=========                                                             |  13%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  18%  |                                                                              |==============                                                        |  20%  |                                                                              |================                                                      |  22%  |                                                                              |=================                                                     |  24%  |                                                                              |===================                                                   |  27%  |                                                                              |====================                                                  |  29%  |                                                                              |======================                                                |  31%  |                                                                              |=======================                                               |  33%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  38%  |                                                                              |============================                                          |  40%  |                                                                              |==============================                                        |  42%  |                                                                              |===============================                                       |  44%  |                                                                              |=================================                                     |  47%  |                                                                              |==================================                                    |  49%  |                                                                              |====================================                                  |  51%  |                                                                              |=====================================                                 |  53%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  58%  |                                                                              |==========================================                            |  60%  |                                                                              |============================================                          |  62%  |                                                                              |=============================================                         |  64%  |                                                                              |===============================================                       |  67%  |                                                                              |================================================                      |  69%  |                                                                              |==================================================                    |  71%  |                                                                              |===================================================                   |  73%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  78%  |                                                                              |========================================================              |  80%  |                                                                              |==========================================================            |  82%  |                                                                              |===========================================================           |  84%  |                                                                              |=============================================================         |  87%  |                                                                              |==============================================================        |  89%  |                                                                              |================================================================      |  91%  |                                                                              |=================================================================     |  93%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  98%  |                                                                              |======================================================================| 100%</div><img src='ia-5.png' alt='' width='540' height='400' /><div class='input'><span class='fu'>plot</span>(<span class='no'>res</span>, <span class='kw'>low</span> <span class='kw'>=</span> <span class='st'>"black"</span>, <span class='kw'>high</span> <span class='kw'>=</span> <span class='st'>"green"</span>, <span class='kw'>index</span> <span class='kw'>=</span> <span class='st'>"Ia"</span>)</div><img src='ia-7.png' alt='' width='540' height='400' /><div class='input'>
<span class='fu'>not_run</span>({

  <span class='co'># Get the indices back and plot the distributions.</span>
  <span class='no'>nansamp</span> <span class='kw'>&lt;-</span> <span class='fu'>ia</span>(<span class='no'>nancycats</span>, <span class='kw'>sample</span> <span class='kw'>=</span> <span class='fl'>999</span>, <span class='kw'>valuereturn</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

  <span class='fu'>plot</span>(<span class='no'>nansamp</span>, <span class='kw'>index</span> <span class='kw'>=</span> <span class='st'>"Ia"</span>)
  <span class='fu'>plot</span>(<span class='no'>nansamp</span>, <span class='kw'>index</span> <span class='kw'>=</span> <span class='st'>"rbarD"</span>)

  <span class='co'># You can also adjust the parameters for how large to display the text</span>
  <span class='co'># so that it's easier to export it for publication/presentations.</span>
  <span class='fu'>library</span>(<span class='st'>"ggplot2"</span>)
  <span class='fu'>plot</span>(<span class='no'>nansamp</span>, <span class='kw'>labsize</span> <span class='kw'>=</span> <span class='fl'>5</span>, <span class='kw'>linesize</span> <span class='kw'>=</span> <span class='fl'>2</span>) +
    <span class='fu'>theme_bw</span>() +                                      <span class='co'># adding a theme</span>
    <span class='fu'>theme</span>(<span class='kw'>text</span> <span class='kw'>=</span> <span class='fu'>element_text</span>(<span class='kw'>size</span> <span class='kw'>=</span> <span class='fu'>rel</span>(<span class='fl'>5</span>))) +       <span class='co'># changing text size</span>
    <span class='fu'>theme</span>(<span class='kw'>plot.title</span> <span class='kw'>=</span> <span class='fu'>element_text</span>(<span class='kw'>size</span> <span class='kw'>=</span> <span class='fu'>rel</span>(<span class='fl'>4</span>))) + <span class='co'># changing title size</span>
    <span class='fu'>ggtitle</span>(<span class='st'>"Index of Association of nancycats"</span>)      <span class='co'># adding a new title</span>

  <span class='co'># Get the index for each population.</span>
  <span class='fu'>lapply</span>(<span class='fu'>seppop</span>(<span class='no'>nancycats</span>), <span class='no'>ia</span>)
  <span class='co'># With sampling</span>
  <span class='fu'>lapply</span>(<span class='fu'>seppop</span>(<span class='no'>nancycats</span>), <span class='no'>ia</span>, <span class='kw'>sample</span> <span class='kw'>=</span> <span class='fl'>999</span>)

  <span class='co'># Plot pairwise ia for all populations in a grid with cowplot</span>
  <span class='co'># Set up the library and data</span>
  <span class='fu'>library</span>(<span class='st'>"cowplot"</span>)
  <span class='fu'>data</span>(<span class='no'>monpop</span>)
  <span class='fu'>splitStrata</span>(<span class='no'>monpop</span>) <span class='kw'>&lt;-</span> ~<span class='no'>Tree</span>/<span class='no'>Year</span>/<span class='no'>Symptom</span>
  <span class='fu'>setPop</span>(<span class='no'>monpop</span>)      <span class='kw'>&lt;-</span> ~<span class='no'>Tree</span>

  <span class='co'># Need to set up a list in which to store the plots.</span>
  <span class='no'>plotlist</span>        <span class='kw'>&lt;-</span> <span class='fu'>vector</span>(<span class='kw'>mode</span> <span class='kw'>=</span> <span class='st'>"list"</span>, <span class='kw'>length</span> <span class='kw'>=</span> <span class='fu'>nPop</span>(<span class='no'>monpop</span>))
  <span class='fu'>names</span>(<span class='no'>plotlist</span>) <span class='kw'>&lt;-</span> <span class='fu'>popNames</span>(<span class='no'>monpop</span>)

  <span class='co'># Loop throgh the populations, calculate pairwise ia, plot, and then</span>
  <span class='co'># capture the plot in the list</span>
  <span class='kw'>for</span> (<span class='no'>i</span> <span class='kw'>in</span> <span class='fu'>popNames</span>(<span class='no'>monpop</span>)){
    <span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'>pair.ia</span>(<span class='no'>monpop</span>[<span class='kw'>pop</span> <span class='kw'>=</span> <span class='no'>i</span>], <span class='kw'>limits</span> <span class='kw'>=</span> <span class='fu'>c</span>(-<span class='fl'>0.15</span>, <span class='fl'>1</span>)) <span class='co'># subset, calculate, and plot</span>
    <span class='no'>plotlist</span><span class='kw'>[[</span><span class='no'>i</span>]] <span class='kw'>&lt;-</span> <span class='kw'>ggplot2</span><span class='kw'>::</span><span class='fu'>last_plot</span>() <span class='co'># save the last plot</span>
  }

  <span class='co'># Use the plot_grid function to plot.</span>
  <span class='fu'>plot_grid</span>(<span class='kw'>plotlist</span> <span class='kw'>=</span> <span class='no'>plotlist</span>, <span class='kw'>labels</span> <span class='kw'>=</span> <span class='fu'>paste</span>(<span class='st'>"Tree"</span>, <span class='fu'>popNames</span>(<span class='no'>monpop</span>)))

})</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Zhian N. Kamvar

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Zhian N. Kamvar, Javier F. Tabima, Jonah C. Brooks.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
