<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Calculate windows of the index of association for genlight objects. — win.ia • poppr</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Calculate windows of the index of association for genlight objects. — win.ia" />

<meta property="og:description" content="Genlight objects can contain millions of loci. Since it does not make much
sense to calculate the index of association over that many loci, this
function will scan windows across the loci positions and calculate the index
of association." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">poppr</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">2.8.0.99.12</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/mlg.html">Analysis of Multilocus Genotypes and Lineages in poppr `r packageVersion('poppr')`</a>
    </li>
    <li>
      <a href="../articles/poppr_manual.html">Data import and manipulation in poppr version `r packageVersion('poppr')`</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/grunwaldlab/poppr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate windows of the index of association for genlight objects.</h1>
    <small class="dont-index">Source: <a href='https://github.com/grunwaldlab/poppr/blob/master/R/bitwise.r'><code>R/bitwise.r</code></a></small>
    <div class="hidden name"><code>win.ia.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Genlight objects can contain millions of loci. Since it does not make much
sense to calculate the index of association over that many loci, this
function will scan windows across the loci positions and calculate the index
of association.</p>
    
    </div>

    <pre class="usage"><span class='fu'>win.ia</span>(<span class='no'>x</span>, <span class='kw'>window</span> <span class='kw'>=</span> <span class='fl'>100L</span>, <span class='kw'>min.snps</span> <span class='kw'>=</span> <span class='fl'>3L</span>, <span class='kw'>threads</span> <span class='kw'>=</span> <span class='fl'>1L</span>,
  <span class='kw'>quiet</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>name_window</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>chromosome_buffer</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>a genlight or <a href='genclone-class.html'>snpclone</a> object.</p></td>
    </tr>
    <tr>
      <th>window</th>
      <td><p>an integer specifying the size of the window.</p></td>
    </tr>
    <tr>
      <th>min.snps</th>
      <td><p>an integer specifying the minimum number of snps allowed per
window. If a window does not meet this criteria, the value will return as
<code>NA</code>.</p></td>
    </tr>
    <tr>
      <th>threads</th>
      <td><p>The maximum number of parallel threads to be used within this
function. Defaults to 1 thread, in which the function will run serially. A
value of 0 will attempt to use as many threads as there are available
cores/CPUs. In most cases this is ideal for speed. Note: this option is
passed to <code><a href='bitwise.ia.html'>bitwise.ia()</a></code> and does not parallelize the windowization process.</p></td>
    </tr>
    <tr>
      <th>quiet</th>
      <td><p>if <code>FALSE</code> (default), a progress bar will be printed to the screen.</p></td>
    </tr>
    <tr>
      <th>name_window</th>
      <td><p>if <code>TRUE</code> (default), the result vector will be named with
the terminal position of the window. In the case where several chromosomes
are represented, the position will be appended using a period/full stop.</p></td>
    </tr>
    <tr>
      <th>chromosome_buffer</th>
      <td><p><em>DEPRECATED</em> if <code>TRUE</code> (default), buffers will be placed
between adjacent chromosomal positions to prevent windows from spanning two
chromosomes.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A value of the standardized index of association for all windows in
each chromosome.</p>
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>this will calculate the standardized index of association from Agapow
and Burt, 2001. See <code><a href='ia.html'>ia()</a></code> for details.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>genlight, <a href='genclone-class.html'>snpclone</a>, <code><a href='ia.html'>ia()</a></code>, <code><a href='samp.ia.html'>samp.ia()</a></code>, <code><a href='bitwise.dist.html'>bitwise.dist()</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'># with structured snps assuming 1e4 positions</span>
<span class='fu'>set.seed</span>(<span class='fl'>999</span>)
<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'>glSim</span>(<span class='kw'>n.ind</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>n.snp.nonstruc</span> <span class='kw'>=</span> <span class='fl'>5e2</span>, <span class='kw'>n.snp.struc</span> <span class='kw'>=</span> <span class='fl'>5e2</span>, <span class='kw'>ploidy</span> <span class='kw'>=</span> <span class='fl'>2</span>)
<span class='fu'>position</span>(<span class='no'>x</span>) <span class='kw'>&lt;-</span> <span class='fu'>sort</span>(<span class='fu'>sample</span>(<span class='fl'>1e4</span>, <span class='fl'>1e3</span>))
<span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='fu'>win.ia</span>(<span class='no'>x</span>, <span class='kw'>window</span> <span class='kw'>=</span> <span class='fl'>300L</span>) <span class='co'># Calculate for windows of size 300</span>
<span class='fu'>plot</span>(<span class='no'>res</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"l"</span>)</div><div class='img'><img src='win.ia-1.png' alt='' width='700' height='433' /></div><div class='input'>
</div><span class='co'># NOT RUN {</span>
<span class='co'># unstructured snps</span>
<span class='fu'>set.seed</span>(<span class='fl'>999</span>)
<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'>glSim</span>(<span class='kw'>n.ind</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>n.snp.nonstruc</span> <span class='kw'>=</span> <span class='fl'>1e3</span>, <span class='kw'>ploidy</span> <span class='kw'>=</span> <span class='fl'>2</span>)
<span class='fu'>position</span>(<span class='no'>x</span>) <span class='kw'>&lt;-</span> <span class='fu'>sort</span>(<span class='fu'><a href='http://dplyr.tidyverse.org/reference/sample.html'>sample</a></span>(<span class='fl'>1e4</span>, <span class='fl'>1e3</span>))
<span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='fu'>win.ia</span>(<span class='no'>x</span>, <span class='kw'>window</span> <span class='kw'>=</span> <span class='fl'>300L</span>) <span class='co'># Calculate for windows of size 300</span>
<span class='fu'>plot</span>(<span class='no'>res</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"l"</span>)

<span class='co'># Accounting for chromosome coordinates</span>
<span class='fu'>set.seed</span>(<span class='fl'>999</span>)
<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'>glSim</span>(<span class='kw'>n.ind</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>n.snp.nonstruc</span> <span class='kw'>=</span> <span class='fl'>5e2</span>, <span class='kw'>n.snp.struc</span> <span class='kw'>=</span> <span class='fl'>5e2</span>, <span class='kw'>ploidy</span> <span class='kw'>=</span> <span class='fl'>2</span>)
<span class='fu'>position</span>(<span class='no'>x</span>) <span class='kw'>&lt;-</span> <span class='fu'>as.vector</span>(<span class='fu'>vapply</span>(<span class='fl'>1</span>:<span class='fl'>10</span>, <span class='kw'>function</span>(<span class='no'>x</span>) <span class='fu'>sort</span>(<span class='fu'><a href='http://dplyr.tidyverse.org/reference/sample.html'>sample</a></span>(<span class='fl'>1e3</span>, <span class='fl'>100</span>)), <span class='fu'>integer</span>(<span class='fl'>100</span>)))
<span class='fu'>chromosome</span>(<span class='no'>x</span>) <span class='kw'>&lt;-</span> <span class='fu'>rep</span>(<span class='fl'>1</span>:<span class='fl'>10</span>, <span class='kw'>each</span> <span class='kw'>=</span> <span class='fl'>100</span>)
<span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='fu'>win.ia</span>(<span class='no'>x</span>, <span class='kw'>window</span> <span class='kw'>=</span> <span class='fl'>100L</span>)
<span class='fu'>plot</span>(<span class='no'>res</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"l"</span>)

<span class='co'># Converting chromosomal coordinates to tidy data</span>
<span class='fu'>library</span>(<span class='st'>"dplyr"</span>)
<span class='fu'>library</span>(<span class='st'>"tidyr"</span>)
<span class='no'>res_tidy</span> <span class='kw'>&lt;-</span> <span class='no'>res</span> <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='http://dplyr.tidyverse.org/reference/reexports.html'>data_frame</a></span>(<span class='kw'>rd</span> <span class='kw'>=</span> <span class='no'>.</span>, <span class='kw'>chromosome</span> <span class='kw'>=</span> <span class='fu'>names</span>(<span class='no'>.</span>)) <span class='kw'>%&gt;%</span> <span class='co'># create two column data frame</span>
  <span class='fu'><a href='http://www.rdocumentation.org/packages/tidyr/topics/separate'>separate</a></span>(<span class='no'>chromosome</span>, <span class='kw'>into</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"chromosome"</span>, <span class='st'>"position"</span>)) <span class='kw'>%&gt;%</span> <span class='co'># get the position info</span>
  <span class='fu'><a href='http://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span>(<span class='kw'>position</span> <span class='kw'>=</span> <span class='fu'>as.integer</span>(<span class='no'>position</span>)) <span class='kw'>%&gt;%</span> <span class='co'># force position as integers</span>
  <span class='fu'><a href='http://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span>(<span class='kw'>chromosome</span> <span class='kw'>=</span> <span class='fu'>factor</span>(<span class='no'>chromosome</span>, <span class='fu'>unique</span>(<span class='no'>chromosome</span>))) <span class='co'># force order chromosomes</span>
<span class='no'>res_tidy</span>

<span class='co'># Plotting with ggplot2</span>
<span class='fu'>library</span>(<span class='st'>"ggplot2"</span>)
<span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/ggplot'>ggplot</a></span>(<span class='no'>res_tidy</span>, <span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/aes'>aes</a></span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>position</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>rd</span>, <span class='kw'>color</span> <span class='kw'>=</span> <span class='no'>chromosome</span>)) +
  <span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/geom_path'>geom_line</a></span>() +
  <span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/facet_wrap'>facet_wrap</a></span>(~<span class='no'>chromosome</span>, <span class='kw'>nrow</span> <span class='kw'>=</span> <span class='fl'>1</span>) +
  <span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/labs'>ylab</a></span>(<span class='fu'>expression</span>(<span class='fu'>bar</span>(<span class='no'>r</span>)[<span class='no'>d</span>])) +
  <span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/labs'>xlab</a></span>(<span class='st'>"terminal position of sliding window"</span>) +
  <span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/labs'>labs</a></span>(<span class='kw'>caption</span> <span class='kw'>=</span> <span class='st'>"window size: 100bp"</span>) +
  <span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/theme'>theme</a></span>(<span class='kw'>axis.text.x</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/element'>element_text</a></span>(<span class='kw'>angle</span> <span class='kw'>=</span> <span class='fl'>90</span>, <span class='kw'>hjust</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>vjust</span> <span class='kw'>=</span> <span class='fl'>0.5</span>)) +
  <span class='fu'><a href='http://www.rdocumentation.org/packages/ggplot2/topics/theme'>theme</a></span>(<span class='kw'>legend.position</span> <span class='kw'>=</span> <span class='st'>"top"</span>)

<span class='co'># }</span><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Zhian N. Kamvar, Jonah C. Brooks

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Zhian N. Kamvar, Javier F. Tabima, Jonah C. Brooks.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

