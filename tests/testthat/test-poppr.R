context("Poppr table tests")

test_that("poppr returns expected PA values", {
  data(Aeut, package = "poppr")
  A.tab <- poppr(Aeut, quiet = TRUE)
  expect_that(A.tab$Pop, is_equivalent_to(as.factor(c("Athena", "Mt. Vernon", "Total"))))
  expect_that(A.tab$N, equals(c(97, 90, 187)))
  expect_that(A.tab$MLG, equals(c(70, 50, 119)))
  expect_that(A.tab$eMLG, equals(c(65.981, 50, 68.453)))
  expect_that(A.tab$SE, equals(c(1.246, 0, 2.989)))
  expect_that(A.tab$H, equals(c(4.063, 3.668, 4.558)))
  expect_that(A.tab$G, equals(c(42.193, 28.723, 68.972)))
  expect_that(A.tab$Hexp, equals(c(0.986, 0.976, 0.991)))
  expect_that(A.tab$E.5, equals(c(0.721, 0.726, 0.720)))
  expect_that(A.tab$Ia, equals(c(2.906, 13.302, 14.371)))
  expect_that(A.tab$rbarD, equals(c(0.072, 0.282, 0.271)))
})

test_that("poppr returns expected codominant values", {
  data(partial_clone, package = "poppr")
  p.tab <- poppr(partial_clone, quiet = TRUE)
  expect_that(p.tab$Pop, is_equivalent_to(as.factor(c("1", "2", "3", "4", "Total"))))
  expect_that(p.tab$N, equals(c(13, 13, 12, 12, 50)))
  expect_that(p.tab$MLG, equals(c(10, 12, 11, 9, 26)))
  expect_that(p.tab$eMLG, equals(c(9.462, 11.154, 11, 9, 9.937)))
  expect_that(p.tab$SE, equals(c(0.499, 0.361, 0, 0, 1.129)))
  expect_that(p.tab$H, equals(c(2.245, 2.458, 2.369, 2.095, 3.072)))
  expect_that(p.tab$G, equals(c(8.895, 11.267, 10.286, 7.2, 17.857)))
  expect_that(p.tab$Hexp, equals(c(0.962, 0.987, 0.985, 0.939, 0.963)))
  expect_that(p.tab$E.5, equals(c(0.935, 0.961, 0.958, 0.87, 0.819)))
  expect_that(p.tab$Ia, equals(c(2.158, 1.875, 1.156, 1.157, 1.935)))
  expect_that(p.tab$rbarD, equals(c(0.243, 0.213, 0.132, 0.133, 0.217)))
})